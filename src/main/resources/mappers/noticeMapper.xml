<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.finalProject.mappers.noticeMapper">

<!-- 공지사항 목록 조회 -->
	<select id="getAllNotices" parameterType="map" resultType="NoticeDTO">
<!--         select notice_no, notice_title, admin_id, notice_type, reg_date -->
<!--         from notices where isDelete='N' and notice_type = 'N' order by reg_date desc -->
		select notice_no, notice_title, admin_id, notice_type, reg_date
		from notices where isDelete='N' and notice_type = 'N' order by reg_date desc
		LIMIT #{startRowIndex}, #{pagingSize}
    </select>

<!-- 이벤트 목록 조회 -->
	<select id="getAllEvents" parameterType="map" resultType="NoticeDTO">
        select notice_no, notice_title, admin_id, notice_type, reg_date
        from notices where isDelete='N' and notice_type = 'E' order by reg_date desc
        LIMIT #{startRowIndex}, #{pagingSize}
    </select>
    
<!--     공지사항 작성 -->
	<insert id="addNotice">
		insert into notices (notice_title, admin_id, notice_type, notice_content, reg_date)
		values (#{noticeTitle}, #{adminId}, #{noticeType}, #{noticeContent}, now())
	</insert>
	
<!--     이벤트 작성 -->
	<insert id="addEvent">
		insert into notices (notice_title, admin_id, notice_type, notice_content, reg_date)
		values (#{noticeTitle}, #{adminId}, #{noticeType}, #{noticeContent}, now())
	</insert>
    
<!-- 공지사항 조회 -->
    <select id="selectNoticeById" resultType="NoticeDTO">
		select notice_no, notice_type, notice_title, notice_content, reg_date, admin_id
		from notices where notice_no = #{noticeNo}
	</select>
	
<!-- 이벤트 조회 -->
    <select id="selectEventById" resultType="NoticeDTO">
		select notice_no, notice_type, notice_title, notice_content, reg_date, admin_id
		from notices where notice_no = #{noticeNo}
	</select>
	
<!-- 공지사항 수정 -->
	<update id="updateNotice" parameterType="NoticeDTO">
		update notices set notice_title = #{notice_title}, admin_id = #{admin_id},
		notice_content = #{notice_content}, notice_type = #{notice_type}
		where notice_no = #{notice_no}
	</update>
	
<!-- 이벤트 수정 -->
	<update id="updateEvent" parameterType="NoticeDTO">
		update notices set notice_title = #{notice_title}, admin_id = #{admin_id},
		notice_content = #{notice_content}, notice_type = #{notice_type}
		where notice_no = #{notice_no}
	</update>
	
<!-- 공지사항 삭제 -->
	<update id="deleteNotice" parameterType="int">
		update notices set isDelete = 'Y', notice_title='', notice_content=''
		where notice_no = #{notice_no}
	</update>
	
<!-- 이벤트 삭제 -->
	<update id="deleteEvent" parameterType="int">
		update notices set isDelete = 'Y', notice_title='', notice_content=''
		where notice_no = #{notice_no}
	</update>
	
<!-- 총 글(데이터) 수 -->
	<select id="getTotalPostCount" resultType="int">
		select count(*) from notices
		where isDelete='N' and notice_type = 'N'
    </select>

<!-- 페이지네이션이 적용된 공지 목록 조회 -->
    <select id="getNoticesWithPagination" resultType="NoticeDTO">
        SELECT notice_no, notice_title, admin_id, notice_type, reg_date
        FROM notices WHERE isDelete='N' AND notice_type = 'N' 
        ORDER BY reg_date DESC LIMIT #{offset}, #{limit}
    </select>
    
<!-- 	<select id="getNotices" parameterType="map" resultType="NoticeDTO"> -->
<!-- 		select * from notices order by reg_date desc limit #{pageSize} offset #{startIndex} -->
<!--     </select> -->
    
<!--     <select id="getAllNotice" resultType="NoticeVO"> -->
<!--     	select * from notices -->
<!--     	<choose> -->
<!--     		<when test="searchType == 'notice_title'"> -->
<!--     			and title like #{searchWord} -->
<!--     		</when> -->
<!--     		<when test="searchType == 'notice_writer'"> -->
<!--     			and title like #{searchWord} -->
<!--     		</when> -->
<!--     		<when test="searchType == 'notice_content'"> -->
<!--     			and title like #{searchWord} -->
<!--     		</when> -->
<!--     	</choose> -->
<!--     </select> -->
    
<!--     <select id="selectTotalCount" resultType="int"> -->
<!--     	select count(*) from notices -->
<!--     </select> -->
    
<!--     <select id="selectTotalCountWithSearchCriteria" resultType="int"> -->
<!--     	select count(*) from notices where notece_type = 'N' -->
<!--     		<choose> -->
<!--     			<when test="searchType == 'notice_title'"> -->
<!--     				and title like #{searchWord} -->
<!--     			</when> -->
<!--     			<when test="searchType == 'notice_writer'"> -->
<!--     				and title like #{searchWord} -->
<!--     			</when> -->
<!--     			<when test="searchType == 'notice_content'"> -->
<!--     				and title like #{searchWord} -->
<!--     			</when> -->
<!--     		</choose> -->
<!--     </select> -->
    
<!-- 게시판 검색 -->
<!-- 	<select id="getSearchBoard" resultType="NoticeVO"> -->
<!-- 		select * from notices -->
<!--     	<choose> -->
<!--     		<when test="searchType == 'notice_title'"> -->
<!--     			and title like #{searchWord} -->
<!--     		</when> -->
<!--     		<when test="searchType == 'notice_writer'"> -->
<!--     			and title like #{searchWord} -->
<!--     		</when> -->
<!--     		<when test="searchType == 'notice_content'"> -->
<!--     			and title like #{searchWord} -->
<!--     		</when> -->
<!--     	</choose> -->
<!-- 	</select> -->
    
</mapper>
  